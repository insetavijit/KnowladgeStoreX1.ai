# Prompt Templates & Variables

**Core definition:** A **Prompt Template** is a reusable string defined in code that contains **Variables** (placeholders) which are dynamically replaced with data at runtime to generate the final prompt sent to the LLM.

**Key idea:**

-   **Separation of Concerns:** Hard-coded instructions vs. dynamic user input.
-   **Scalability:** Writing one prompt to handle 1,000 distinct user queries.
-   **Safety:** Sanitizing or managing how variables are injected.

## Why It Matters

In production, you never type a manual prompt. You build software where the prompt is a function: `get_prompt(user_name, user_question)`. Templates allow engineering teams to version control, test, and optimize prompts systematically without changing the underlying code logic.

## Essential Functions

**1. Variable Injection:**
Inserting dynamic data.
*   Template: `Hello {name}, how are you?`
*   Data: `name="Alice"`
*   Result: `Hello Alice, how are you?`

**2. Conditional Logic:**
Changing the prompt based on variables (handled in code, not the LLM).
*   If `is_premium_user`: Insert "Give detailed analysis."
*   Else: Insert "Give brief summary."

**3. Partial Formatting:**
Locking in some variables (like context) while leaving others (like query) open for later.

## Anatomy of a Template

**Python Style (f-string):**
```python
user_input = "How do I fix a flat tire?"
tone = "helpful"

prompt = f"""
You are a {tone} assistant.
Answer the following question:
{user_input}
"""
```

**Handlebars / Mustache Attributes:**
```text
You are an expert in {{domain}}.
Answer the user's question about {{topic}}:
Question: {{question}}
```

**LangChain Style:**
```python
template = "Translate the following text to {language}: {text}"
prompt = PromptTemplate(template=template, input_variables=["language", "text"])
```

## Risks & Best Practices

| Risk | Description | Mitigation |
| :--- | :--- | :--- |
| **Prompt Injection** | User variable contains instructions (e.g., "Ignore rules"). | Use Delimiters around variables: `"""{user_input}"""`. |
| **Unbounded Input** | Variable is too large for context window. | Truncate variables in code before injection. |
| **Empty Variables** | Missing data breaks the sentence structure. | Logic to handle `None` values or provide defaults. |

## Common Patterns

**1. The "Sandbox" Template**
Always wrapping user variables in clear delimiters.
`Analysis of: <input>{user_input}</input>`

**2. The "Persona" Variable**
Dynamically swapping the system message based on the user's role.
`System: You are an assistant for a {user_role}.`

**3. The Few-Shot Template**
Dynamically injecting relevant examples based on the query (Dynamic Few-Shot).

## Quick Summaries

**30-second version:**
Prompt Templates are the engineering layer on top of raw text prompts. They turn static text into dynamic functions. By using placeholders like `{text}` or `{{variable}}`, developers can build systems that automatically assemble prompts with the right context, user data, and instructions for every unique request, scaling from one-off chats to massive applications.

**One-line recall:**
**Template = Static Instructions + Dynamic Variables.**

---

**Section:** **1.1.2.8 Prompt Templates & Variables**
**Focus:** Engineering & Reusability
**Last updated:** December 2025

---
